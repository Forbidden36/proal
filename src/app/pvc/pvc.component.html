
<div class="d-flex justify-content-end">
    <span class="printNoDisplay datum ">{{today | date}}</span>
</div>
<div class="printNoDisplay container w-25 text-center">    
    <p class="donjaCrta"></p>
</div>
<div class="printNoDisplay container">
    <table class="table table-sm table-responsive">
        <thead>
            <tr class="table-light">
                <th scope="col">r.b.</th>
                <th scope="col">Sifra</th>
                <th scope="col">Opis</th>
                <th scope="col">Kolicina</th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let ok of konacanOkov; index as i; trackBy: trackByFn">
                <td>{{i + 1}}</td>
                <td>{{ok.id}}</td>
                <td>{{ok.opis}}</td>
                <td>{{ok.kolicina}}</td>                           
            </tr>
        </tbody>
    </table>
</div>
<div class="container-lg noPrint w-80 main">
    <div class="closeBar row row-cols-1">
        <div class="col-8">    
          <p style="margin-top: auto; margin-bottom: auto;">Okov za PVC</p>
        </div>
        <div class="col-4 closeButton" >
         <a routerLink="/HOME" routerLinkActive="active" ariaCurrentWhenActive="page">X</a>
        </div>
    </div>
    <form [formGroup]="pozicija">
        <div #collapse="ngbCollapse" [(ngbCollapse)]="isCollapsed">
        <div class="nacinOtvaranja">
            <input  type="radio" class="btn-check" name="nacinOtvaranja" id="kombinovano" (change)="otvRadio($event)" value="kombinovano" onclick="this.blur()" formControlName="nacinOtvaranja">
            <label for="kombinovano" class="btn btn-outline-secondary otvaranja">Kombinovano</label>
            <input type="radio" name="nacinOtvaranja" class="btn-check" id="okretno" (change)="otvRadio($event)" value="okretno" onclick="this.blur()"  formControlName="nacinOtvaranja">
            <label for="okretno" class="btn btn-outline-secondary otvaranja">Okretno</label>
            <input type="radio" class="btn-check" name="nacinOtvaranja" id="nagibno" (change)="otvRadio($event)" value="nagibno" onclick="this.blur()" formControlName="nacinOtvaranja">
            <label for="nagibno" class="btn btn-outline-secondary otvaranja">Nagibno</label> 
        </div>
    </div>
        <div class="row">
            <div class="tipMere col-lg-2">
                <div #collapse="ngbCollapse" [(ngbCollapse)]="isCollapsed">
                <h6 class="mb-2"><i>Tip mera</i></h6>
                    <label for="nazivnaM"><input  type="radio"  name="tipMere" id="nazivnaM" value="nazivnaMera" formControlName="tipMere"><span>Nazivna mera</span></label>
                    <label for="falcnaM"><input  type="radio"  name="tipMere" id="falcnaM" value="falcnaMera" formControlName="tipMere"><span>Falcna mera</span></label>
                </div>
            </div>
            <div class="colorPicker col-lg-2">
                <div #collapse="ngbCollapse" [(ngbCollapse)]="isCollapsed">
                <h6><i>Izabrati boju</i></h6>
                <label class="belo">
                    <input type="radio" value="belo" id="belo" formControlName="boja"><div class="button"><span></span></div>
                </label>
                <label class="braon">
                    <input type="radio" value="braon" id="braon" formControlName="boja"><div class="button"><span></span></div>
                </label>
                <label class="crno">
                    <input type="radio" value="crno" id="crno" formControlName="boja"><div class="button"><span></span></div>
                </label>  
            </div>
            </div>
            <div class="col-lg-5 deoForme">
                <button type="button" class="colButton" (click)="collapse.toggle(); changeColBtnName()" [attr.aria-expanded]="!isCollapsed"
                aria-controls="collapseExample">
                {{collapseButtonName}}
              </button>
<!-- 205-9001018466995-74 -->

                <div class="brKr">
                    <label for="brojKrila">Broj Krila: </label>
                    <input  type="radio" [value]=1 formControlName="brojKrila">1
                    <input  type="radio" [value]=2 formControlName="brojKrila">2
                    <input  type="radio" [value]=3 formControlName="brojKrila">3
                </div>
                <div class="otv">
                    <label for="otvaranje">Otvaranje: </label>
                    <input  type="radio" value="levo"  formControlName="otvaranje">Levo 
                    <input  type="radio" value="desno" formControlName="otvaranje">Desno
                </div>
                <div class="neMoze">
                    <p *ngIf = "pozicija.get('visina')?.touched && pozicija.get('sirina')?.touched && pozicija.errors?.['nemogucOdnosSirineIVisine']">Nemoguc odnos sirine i visine</p>
                </div>
                <div class="sirVis">
                    <label for="sirina">Sirina: </label>
                    <input  type="number" class="sirVisInput" [ngClass]="{'greskaValidacije': pozicija.get('sirina')?.touched && pozicija.errors?.['sirinaVelikaONO'] ||
                    pozicija.get('sirina')?.touched && pozicija.errors?.['sirinaMalaON'] || pozicija.get('sirina')?.touched && pozicija.errors?.['sirinaMalaNO'] ||
                    pozicija.get('sirina')?.touched && pozicija.errors?.['sirinaMalaON'], 'nemoguceAB': pozicija.get('sirina')?.touched && pozicija.get('visina')?.touched && pozicija.errors?.['nemogucOdnosSirineIVisine']}" id="sirina" required placeholder="Sirina" formControlName="sirina">
            
                    <label for="visina">Visina: </label>
                    <input  type="number" id="visina" class="sirVisInput" 
                    [ngClass]="{'greskaValidacije': pozicija.get('visina')?.touched && pozicija.errors?.['visinaMala'] ||
                                                    pozicija.get('visina')?.touched && pozicija.errors?.['visinaMalaCentRing'] ||
                                                    pozicija.get('visina')?.touched && pozicija.errors?.['visinaMalaCentRingSigKip'] ||
                                                    pozicija.get('visina')?.touched && pozicija.errors?.['visinaMalaSigKip'] ||
                                                    pozicija.get('visina')?.touched && pozicija.errors?.['visinaVelika'] ||
                                                    pozicija.get('visina')?.touched && pozicija.errors?.['visinaMalaOkretna'] ||
                                                    pozicija.get('visina')?.touched && pozicija.errors?.['visinaMalaNagibna'] ||
                                                    pozicija.get('visina')?.touched && pozicija.errors?.['visinaVelikaNagibna'],

                                'nemoguceAB':       pozicija.get('visina')?.touched && pozicija.get('sirina')?.touched && pozicija.errors?.['nemogucOdnosSirineIVisine']}"
  
                                                
                                                     
                    required placeholder="Visina" formControlName="visina"><br>
                </div>
                <div class="greske">
                    <p *ngIf = "pozicija.get('sirina')?.touched && pozicija.errors?.['sirinaVelikaONO']">Maximalna falcna sirina iznosi 1400<span class="jedMere">[mm]</span></p>
                    <p *ngIf = "pozicija.get('sirina')?.touched && pozicija.errors?.['sirinaMalaON']">Minimalna falcna sirina iznosi 320<span class="jedMere">[mm]</span></p>
                    <p *ngIf = "pozicija.get('sirina')?.touched && pozicija.errors?.['sirinaMalaNO']">Minimalna falcna sirina iznosi 250<span class="jedMere">[mm]</span></p>
                    <p *ngIf = "pozicija.get('sirina')?.touched && pozicija.errors?.['sirinaVelikaN']">Maximalna falcna sirina iznosi 2400<span class="jedMere">[mm]</span></p>

                    <p *ngIf = "pozicija.get('visina')?.touched && pozicija.errors?.['visinaMala']">Minimalna falcna visina iznosi 250<span class="jedMere">[mm]</span></p>
                    <p *ngIf = "pozicija.get('visina')?.touched && pozicija.errors?.['visinaMalaCentRing']">Minimalna falcna visina sa <i>centralnom ringlom</i> iznosi 450<span class="jedMere">[mm]</span></p>
                    <p *ngIf = "pozicija.get('visina')?.touched && pozicija.errors?.['visinaMalaCentRingSigKip']">Minimalna falcna visina sa <i>centr.ringlom</i> i <i>sig.kipom</i> iznosi 380<span class="jedMere">[mm]</span></p>
                    <p *ngIf = "pozicija.get('visina')?.touched && pozicija.errors?.['visinaMalaSigKip']">Minimalna falcna visina sa <i>sig.kipom</i> iznosi 330<span class="jedMere">[mm]</span></p>
                    <p *ngIf = "pozicija.get('visina')?.touched && pozicija.errors?.['visinaVelika']">Maximalna falcna visina 2400<span class="jedMere">[mm]</span></p>
                    <p *ngIf = "pozicija.get('visina')?.touched && pozicija.errors?.['visinaMalaOkretna']">Minimalna falcna visina iznosi 180<span class="jedMere">[mm]</span></p>
                    <p *ngIf = "pozicija.get('visina')?.touched && pozicija.errors?.['visinaMalaNagibna']">Minimalna falcna visina iznosi 300<span class="jedMere">[mm]</span></p>
                    <p *ngIf = "pozicija.get('visina')?.touched && pozicija.errors?.['visinaVelikaNagibna']">Maximalna falcna visina iznosi 1200<span class="jedMere">[mm]</span></p>
                  </div>
                <div class="kolicina">
                    <label for="kolicina">Kolicina: </label>
                    <input  type="number" placeholder="Kolicina" formControlName="kolicina"><br>
                </div>

            </div>
            <div class="col-lg-3 opcije">
                <h6>Dodatne opcije</h6>
                <label for="sigurnosniKip"><span>Sigurnosni kip</span><input type="checkbox" value="sigurnosniKip" formControlName="sigurnosniKip"></label>
                <label for="centralnaRingla">Centralna ringla<input type="checkbox" value="centralnaRingla" formControlName="centralnaRingla"></label>
                <label for="sigurnosnaRucica">Sigurnosna rucica<input type="checkbox" value="sigurnosnaRucica" formControlName="sigurnosnaRucica"></label>
            </div>  
        </div> 
        <div class="d-grid gap-2 col-3 mx-auto potvrdiDugme">
            <button class="btn btn-outline-success" type="button" [disabled]="!pozicija.valid" (click)="onSubmit()">Potvrdi</button>
        </div>     
    </form>
</div>
<!-- <div class="text-center" >
    <div class="spinner-border" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
  </div> -->
<div class="noPrint container mx-auto m-0 row dugmadZaMaliEkran">
    <div class="col-lg-6">
        <div class="d-grid col-lg-6 mx-auto potvrdiDugme">
            <div class="btn-group" role="group">
                <button class="btn btn-outline-primary" type="button" [disabled]="pozicije.length === 0" (click)="izracunajStampaj()">Nalog za odvajanje</button>
                <button class="btn btn-outline-primary" type="button" [disabled]="pozicije.length === 0" onclick="this.blur()" (click)="openFullscreen(content)">Izmeni</button>

            </div>
            
        </div> 
    </div>
    <div class="col-lg-6 modalDugme">
        <div class="d-grid col-lg-6 mx-auto potvrdiDugme">
            <button class="btn btn-outline-secondary" type="button" [disabled]="pozicije.length === 0" onclick="this.blur()" (click)="openScrollableContent(longContent)">Lista pozicija</button>
        </div> 
    </div>
    <div class="col-lg-6">
        <div class="d-grid col-lg-6 mx-auto potvrdiDugme">
            <button class="btn btn-outline-dark" type="button" [disabled]="pozicije.length ===0" onclick="this.blur()" (click)="izracunajCenu()">{{cena}}</button>
        </div> 
    </div>
</div>
<div class="container listaPozicija noPrint">
    <table class="table table-sm table-responsive">
        <thead>
            <tr class="table-light">
                <th scope="col">r.b.</th>
                <th scope="col">F.Sirina</th>
                <th scope="col">F.Visina</th>
                <th scope="col">Br.Krila</th>
                <th scope="col">Otvaranje</th>
                <th scope="col">Nacin Otvaranja</th>
                <th scope="col">Opis</th>
                <th scope="col">Kom.</th>
                <th scope="col"></th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let pos of pozicije; index as i; trackBy: trackByFn">
                <td>{{i + 1}}</td>
                <td>{{pos.sirina}}</td>
                <td>{{pos.visina}}</td>
                <td>{{pos.brojKrila}}</td>
                <td>{{pos.otvaranje}}</td>
                <td>{{pos.nacinOtvaranja}}</td>
                <td>{{pos.opis}}</td>
                <td>{{pos.kolicina}}</td>                
                <th><button class="maliDel" (click)="deleteRow(i)">X</button></th>            
            </tr>
        </tbody>
    </table>
</div>
<div class="footer">
    <span>M&J<sup>&#174;</sup></span>
</div>
<ng-template #longContent let-modal>
    <div class="modal-header">
      <h5 class="modal-title">Lista pozicija</h5>
    </div>
    <div class="modal-body">
        <div class="container listaPozicijaModal noPrint">
            <table class="table table-sm table-responsive">
                <thead>
                    <tr class="table-light">
                        <th scope="col">r.b.</th>
                        <th scope="col">Falcna sirina</th>
                        <th scope="col">Falcna visina</th>
                        <th scope="col">Broj krila</th>
                        <th scope="col">Otvaranje</th>
                        <th scope="col">Nacin Otvaranja</th>
                        <th scope="col">Opis</th>
                        <th scope="col">Kom.</th>
                        <th scope="col"></th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let pos of pozicije; index as i; trackBy: trackByFn">
                        <td>{{i + 1}}</td>
                        <td>{{pos.sirina}}</td>
                        <td>{{pos.visina}}</td>
                        <td>{{pos.brojKrila}}</td>
                        <td>{{pos.otvaranje}}</td>
                        <td>{{pos.nacinOtvaranja}}</td>
                        <td>{{pos.opis}}</td>
                        <td>{{pos.kolicina}}</td>                
                        <th><button class="maliDel" (click)="deleteRow(i)">X</button></th>            
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-light" (click)="modal.close('Close click')">Close</button>
  </div>
</ng-template> 
<ng-template #content let-modal>
	<div class="modal-header text-center">
        <h6 class="modal-title">Izmenjen nalog za odvajanje</h6>
        <button type="button" class="noPrint printButton" onclick="this.blur()" (click)="stampajIzmenjenOkov()">Stampaj</button>
        <button type="button" class="modalCloseButton noPrint" (click)="modal.close('Close click')">X</button>
        <div class="d-flex justify-content-end">
            <span class="printNoDisplay datum ">{{today | date}}</span>
        </div>	
	</div>
	<div class="modal-body">
		<div class="container">
            <div class="noPrint dodajForma">
                <form [formGroup]="dodajElement">
                    <select formControlName="element">
                        <option *ngFor="let item of dataService.JOVAN" [ngValue]="item.id">
                            {{item.id}}: {{item.opis}}
                        </option>
                    </select>
                    <input type="number" formControlName="kolicina" placeholder="Kolicina" required>
                    <button type="button" [disabled]="!dodajElement.valid" class="dodajElementDugme" (click)="dodajItemSubmit()">Dodaj elemenat</button>
                </form>
            </div>
            <table class="table table-sm table-responsive table-hover">
                <thead>
                    <tr class="table-light">
                        <th scope="col">r.b.</th>
                        <th scope="col">Sifra</th>
                        <th scope="col">Opis</th>
                        <th scope="col">Kolicina</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let ok of konacanOkov; index as i; trackBy: trackByFn">
                        <td>{{i + 1}}</td>
                        <td>{{ok.id}}</td>
                        <td>{{ok.opis}}</td>
                        <td class="izmenaKolicine"><input type="number" [(ngModel)]="ok.kolicina"><button class="maliDel noPrint" (click)="deleteItem(i)">X</button></td>                           
                    </tr>
                </tbody>
            </table>
        </div>
	</div>
</ng-template>


